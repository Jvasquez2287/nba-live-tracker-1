import{r as g,j as e,B as c,w as B,v as N,S as v}from"./index-BeuNjhzr.js";import{a as H,k as K,P as k,d as j,t as s,A as X,N as U,m as R,n as _}from"./Navbar-MuDbTouq.js";import{T as d}from"./Button-D9sHacpw.js";import{a6 as J,a7 as Q,a8 as q,a9 as I,aa as V,ad as Z,ab as T}from"./CartesianChart-BkSJFr0W.js";import{A as ee,L as se,a as te,b as ie}from"./teamColors-BvzSDVvK.js";import{p as re,f as C}from"./parseISO-D6CdGl5U.js";import{g as oe}from"./season-CT1Q602E.js";import{A as ne}from"./Alert-su9Uuwqx.js";import{T as ae,a as le,b as xe,c as M,d as n,e as de}from"./TableRow-DcBWEryx.js";const ce=({data:h})=>{const r=H(),t=K(r.breakpoints.down("sm")),a=g.useMemo(()=>!h.games||h.games.length===0?[]:[...h.games].slice(0,20).reverse().map((o,y)=>{const i=re(o.game_date),p=o.points+o.rebounds+o.assists+o.steals+o.blocks-o.turnovers;return{index:y,date:C(i,"MMM d"),fullDate:o.game_date,Points:o.points,EPI:Math.max(0,p)}}),[h.games]),m=g.useMemo(()=>{if(a.length===0)return{Points:0,EPI:0};const x=a.reduce((o,y)=>({Points:o.Points+y.Points,EPI:o.EPI+y.EPI}),{Points:0,EPI:0});return{Points:x.Points/a.length,EPI:x.EPI/a.length}},[a]),b=g.useMemo(()=>Math.max(...a.map(x=>x.Points),0),[a]),u=g.useMemo(()=>Math.max(...a.map(x=>x.EPI),0),[a]);if(a.length===0)return e.jsx(k,{elevation:0,sx:{p:3,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:j.md},children:e.jsx(d,{variant:"body2",color:"text.secondary",textAlign:"center",children:"No game data available"})});const l="#1976d2",f="#2e7d32";return e.jsxs(k,{elevation:0,sx:{p:{xs:2,sm:3.5},backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:j.md},children:[e.jsx(d,{variant:"h6",sx:{fontWeight:s.weight.bold,mb:3,fontSize:s.size.h6,color:"text.primary"},children:"Recent Performance Trend"}),e.jsx(J,{width:"100%",height:t?320:420,children:e.jsxs(ee,{data:a,margin:{top:20,right:t?30:50,left:t?20:30,bottom:t?60:40},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"pointsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:l,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:l,stopOpacity:0})]})}),e.jsx(Q,{strokeDasharray:"3 3",stroke:r.palette.divider,strokeOpacity:.3,vertical:!0,horizontal:!0}),e.jsx(q,{dataKey:"index",stroke:r.palette.text.secondary,style:{fill:r.palette.text.secondary,fontSize:t?"0.75rem":"0.8125rem",fontWeight:s.weight.medium},tickLine:{stroke:r.palette.text.secondary},axisLine:{stroke:r.palette.divider},angle:t?-45:0,textAnchor:t?"end":"middle",height:t?80:50,tickFormatter:x=>{const o=a[x];return(o==null?void 0:o.date)||""},interval:t?a.length>15?4:a.length>10?3:2:a.length>15?2:a.length>10?1:0}),e.jsx(I,{yAxisId:"left",stroke:r.palette.text.secondary,style:{fill:r.palette.text.secondary,fontSize:t?"0.75rem":"0.8125rem",fontWeight:s.weight.medium},domain:[0,Math.ceil(b*1.1)],tickLine:{stroke:r.palette.text.secondary},axisLine:{stroke:r.palette.divider},label:{value:"Points",angle:-90,position:"insideLeft",style:{fill:l,fontWeight:s.weight.semibold,fontSize:t?"0.75rem":"0.875rem"}}}),e.jsx(I,{yAxisId:"right",orientation:"right",stroke:r.palette.text.secondary,style:{fill:r.palette.text.secondary,fontSize:t?"0.75rem":"0.8125rem",fontWeight:s.weight.medium},domain:[0,Math.ceil(u*1.1)],tickLine:{stroke:r.palette.text.secondary},axisLine:{stroke:r.palette.divider},label:{value:"EPI",angle:90,position:"insideRight",style:{fill:f,fontWeight:s.weight.semibold,fontSize:t?"0.75rem":"0.875rem"}}}),e.jsx(V,{content:({active:x,payload:o,label:y})=>x&&o&&o.length?e.jsxs(k,{elevation:8,sx:{p:1.5,backgroundColor:r.palette.background.paper,border:`1px solid ${r.palette.divider}`,borderRadius:j.sm,boxShadow:r.palette.mode==="dark"?"0 8px 24px rgba(0, 0, 0, 0.5)":"0 4px 12px rgba(0, 0, 0, 0.15)"},children:[e.jsx(d,{variant:"body2",sx:{fontWeight:s.weight.bold,color:r.palette.text.primary,mb:1,fontSize:s.size.bodySmall},children:y}),o.map((i,p)=>{var S;const z=i.dataKey==="Points"?l:f;return e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(c,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:z}}),e.jsxs(d,{variant:"body2",sx:{color:r.palette.text.secondary,fontSize:s.size.bodySmall,minWidth:80},children:[i.name,":"]}),e.jsx(d,{variant:"body2",sx:{fontWeight:s.weight.bold,color:z,fontSize:s.size.bodySmall},children:((S=i.value)==null?void 0:S.toFixed(1))||"N/A"})]},p)})]}):null,cursor:{stroke:r.palette.divider,strokeWidth:1,strokeDasharray:"5 5"}}),e.jsx(se,{wrapperStyle:{paddingTop:t?"16px":"24px"},iconType:"line",formatter:x=>e.jsx("span",{style:{color:r.palette.text.primary,fontSize:t?"0.75rem":"0.875rem"},children:x})}),e.jsx(Z,{yAxisId:"left",type:"monotone",dataKey:"Points",stroke:l,fill:"url(#pointsGradient)",strokeWidth:2,dot:{r:t?3:4,fill:l,strokeWidth:1,stroke:r.palette.background.paper},activeDot:{r:t?5:6,fill:l,strokeWidth:1,stroke:r.palette.background.paper},name:`Points (Avg: ${m.Points.toFixed(1)})`,animationDuration:800,animationBegin:0}),e.jsx(te,{yAxisId:"right",type:"monotone",dataKey:"EPI",stroke:f,strokeWidth:2,dot:{r:t?3:4,fill:f,strokeWidth:1,stroke:r.palette.background.paper},activeDot:{r:t?5:6,fill:f,strokeWidth:1,stroke:r.palette.background.paper},name:`EPI (Avg: ${m.EPI.toFixed(1)})`,animationDuration:800,animationBegin:100}),e.jsx(T,{yAxisId:"left",y:m.Points,stroke:l,strokeDasharray:"5 5",strokeOpacity:.4}),e.jsx(T,{yAxisId:"right",y:m.EPI,stroke:f,strokeDasharray:"5 5",strokeOpacity:.4})]})})]})},me=({playerId:h,firstName:r,lastName:t,teamCity:a,teamName:m,jerseyNumber:b,position:u,stats:l,height:f,weight:x})=>{const o=a&&m?ie(a,m):{primary:"#1976d2",text:"#FFFFFF"};return e.jsx(c,{sx:{width:"100%",backgroundColor:o.primary,color:o.text,borderRadius:0,py:3,px:3,mb:3},children:e.jsxs(c,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},gap:3},children:[e.jsx(X,{src:`https://cdn.nba.com/headshots/nba/latest/1040x760/${h}.png`,alt:`${r} ${t}`,sx:{width:{xs:80,sm:100},height:{xs:80,sm:100},backgroundColor:"transparent",border:`2px solid ${o.text}`,flexShrink:0},onError:y=>{const i=y.currentTarget;i.onerror=null,i.src="/fallback-player.png"}}),e.jsxs(c,{sx:{flex:1,minWidth:0},children:[e.jsxs(d,{variant:"caption",sx:{display:"block",mb:.5,fontSize:"0.75rem",opacity:.9,textTransform:"uppercase",letterSpacing:"0.05em"},children:[m?`${a} ${m}`:"Free Agent"," ",b&&`â€¢ #${b}`," ",u&&`â€¢ ${u}`]}),e.jsxs(d,{variant:"h4",sx:{fontWeight:600,fontSize:{xs:"1.5rem",sm:"1.75rem",md:"2rem"},color:o.text,mb:1},children:[r," ",t]}),l&&e.jsxs(c,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",sm:"repeat(5, 1fr)"},gap:2,mt:2},children:[l.ppg!==void 0&&e.jsxs(c,{children:[e.jsx(d,{variant:"caption",sx:{display:"block",mb:.5,opacity:.8,fontSize:"0.75rem"},children:"PPG"}),e.jsx(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.875rem"},children:l.ppg.toFixed(1)})]}),l.rpg!==void 0&&e.jsxs(c,{children:[e.jsx(d,{variant:"caption",sx:{display:"block",mb:.5,opacity:.8,fontSize:"0.75rem"},children:"RPG"}),e.jsx(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.875rem"},children:l.rpg.toFixed(1)})]}),l.apg!==void 0&&e.jsxs(c,{children:[e.jsx(d,{variant:"caption",sx:{display:"block",mb:.5,opacity:.8,fontSize:"0.75rem"},children:"APG"}),e.jsx(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.875rem"},children:l.apg.toFixed(1)})]}),f&&e.jsxs(c,{children:[e.jsx(d,{variant:"caption",sx:{display:"block",mb:.5,opacity:.8,fontSize:"0.75rem"},children:"HEIGHT"}),e.jsx(d,{variant:"body2",sx:{fontWeight:500,fontSize:"0.875rem"},children:f})]}),x&&e.jsxs(c,{children:[e.jsx(d,{variant:"caption",sx:{display:"block",mb:.5,opacity:.8,fontSize:"0.75rem"},children:"WEIGHT"}),e.jsxs(d,{variant:"body2",sx:{fontWeight:500,fontSize:"0.875rem"},children:[x," lbs"]})]})]})]})]})})},ze=()=>{const{playerId:h}=B(),[r]=N(),[t,a]=g.useState(null),[m,b]=g.useState(null),[u,l]=g.useState(!0),[f,x]=g.useState(null),o=r.get("season")||oe();g.useEffect(()=>{if(!h)return;(async()=>{l(!0),x(null);try{const p=await R(`${_}/api/v1/player/${h}`,{},{maxRetries:3,retryDelay:1e3,timeout:3e4});a(p)}catch(p){x(p instanceof Error?p.message:"Failed to load player. Please try again.")}finally{l(!1)}})()},[h]),g.useEffect(()=>{if(!h)return;(async()=>{try{const p=await R(`${_}/api/v1/player/${h}/game-log?season=${encodeURIComponent(o)}`,{},{maxRetries:3,retryDelay:1e3,timeout:3e4});b(p)}catch(p){console.error("Error fetching game log:",p)}})()},[h,o]);const y=t!=null&&t.FROM_YEAR&&(t!=null&&t.TO_YEAR)?`${t.TO_YEAR-t.FROM_YEAR} Years`:"N/A";return e.jsxs(c,{sx:{minHeight:"100dvh",backgroundColor:"background.default",display:"flex",flexDirection:"column",maxWidth:"100vw",overflowX:"hidden",overflowY:"visible",width:"100%"},children:[e.jsx(U,{}),e.jsx(c,{sx:{maxWidth:"1400px",mx:"auto",px:{xs:1,sm:2,md:3,lg:4},py:{xs:2,sm:3},width:"100%",overflowX:"hidden"},children:u?e.jsxs(c,{sx:{minHeight:400,display:"flex",flexDirection:"column",gap:2},children:[e.jsx(v,{variant:"rectangular",height:200,sx:{borderRadius:2,mb:2}}),e.jsx(v,{variant:"rectangular",height:100,sx:{borderRadius:2}}),e.jsx(v,{variant:"rectangular",height:300,sx:{borderRadius:2}})]}):f?e.jsx(ne,{severity:"error",sx:{minHeight:100},children:f}):t?e.jsxs(e.Fragment,{children:[e.jsx(me,{playerId:t.PERSON_ID,firstName:t.PLAYER_FIRST_NAME,lastName:t.PLAYER_LAST_NAME,teamCity:t.TEAM_CITY,teamName:t.TEAM_NAME,jerseyNumber:t.JERSEY_NUMBER,position:t.POSITION,stats:{ppg:t.PTS,rpg:t.REB,apg:t.AST},height:t.HEIGHT,weight:t.WEIGHT,country:t.COUNTRY,school:t.COLLEGE,age:t.FROM_YEAR&&t.TO_YEAR?new Date().getFullYear()-t.FROM_YEAR:void 0,birthdate:void 0,draft:t.FROM_YEAR?`${t.FROM_YEAR} R1 Pick 23`:void 0,experience:y}),m&&m.games.length>0&&e.jsx(c,{sx:{mb:{xs:4,sm:5}},children:e.jsx(ce,{data:m})}),m&&m.games.length>0&&e.jsx(c,{sx:{mb:{xs:4,sm:5}},children:e.jsxs(k,{elevation:0,sx:{p:{xs:2,sm:3},backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:j.md},children:[e.jsx(d,{variant:"h6",sx:{fontWeight:s.weight.bold,mb:{xs:2,sm:3},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.h6}},children:"Game Log"}),e.jsx(c,{sx:{overflowX:"auto",WebkitOverflowScrolling:"touch",width:"100%",maxWidth:"100%"},children:e.jsx(ae,{sx:{overflowX:"auto",width:"100%",maxWidth:"100%",minWidth:{xs:700,sm:"auto"},"@media (hover: hover)":{"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"background.default"},"&::-webkit-scrollbar-thumb":{backgroundColor:"divider",borderRadius:j.xs,"&:hover":{backgroundColor:"text.secondary"}}}},children:e.jsxs(le,{size:"small",sx:{width:"100%",tableLayout:"auto"},children:[e.jsx(xe,{children:e.jsxs(M,{children:[e.jsx(n,{sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"Date"}),e.jsx(n,{sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"Opponent"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"Result"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"MIN"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"PTS"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"REB"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"AST"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"STL"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"BLK"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"TO"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"FG"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"3P"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"FT"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2.5},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.caption.xs,sm:s.editorial.helper.xs},color:"text.secondary"},children:"+/-"})]})}),e.jsx(de,{children:m.games.slice(0,20).map(i=>{var W,A;let p=i.matchup;i.matchup.includes("@")?p=((W=i.matchup.split("@")[1])==null?void 0:W.trim())||i.matchup:i.matchup.includes("vs")&&(p=((A=i.matchup.split(/vs\.?/)[1])==null?void 0:A.trim())||i.matchup);const z=C(new Date(i.game_date),"MMM d"),S=i.win_loss||"-",F=i.field_goals_made??0,P=i.field_goals_attempted??0,L=P>0?`${F}/${P}`:"-",$=i.three_pointers_made??0,w=i.three_pointers_attempted??0,O=w>0?`${$}/${w}`:"-",D=i.free_throws_made??0,E=i.free_throws_attempted??0,G=E>0?`${D}/${E}`:"-",Y=i.plus_minus!==void 0&&i.plus_minus!==null?i.plus_minus>0?`+${i.plus_minus}`:i.plus_minus.toString():"-";return e.jsxs(M,{sx:{transition:"background-color 0.2s ease-in-out","&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(n,{sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:z}),e.jsx(n,{sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:p}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm},color:S==="W"?"success.main":S==="L"?"error.main":"text.secondary"},children:S}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.minutes||"-"}),e.jsx(n,{align:"center",sx:{fontWeight:s.weight.semibold,py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.points}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.rebounds}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.assists}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.steals}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.blocks}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:i.turnovers}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:L}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:O}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm}},children:G}),e.jsx(n,{align:"center",sx:{py:{xs:1.5,sm:2},px:{xs:.75,sm:1.5},fontSize:{xs:s.size.bodySmall.xs,sm:s.size.bodySmall.sm},color:i.plus_minus&&i.plus_minus>0?"success.main":i.plus_minus&&i.plus_minus<0?"error.main":"text.primary"},children:Y})]},i.game_id)})})]})})})]})})]}):e.jsx(c,{sx:{minHeight:400,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{variant:"body1",color:"text.secondary",textAlign:"center",children:"Player not found."})})})]})};export{ze as default};
